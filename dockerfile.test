# Test environment for Wireguard Exporter
FROM golang:1.25-alpine

# Install WireGuard tools and testing utilities
RUN apk add --no-cache \
    wireguard-tools \
    bash \
    curl \
    git

WORKDIR /app

# Copy dependency files for caching
COPY src/go.mod src/go.sum ./

# Download dependencies
RUN go mod download

# Copy source code
COPY src/ ./

# Verify Go version
RUN go version

# Run tests by default
CMD ["go", "test", "-v", "./..."]
